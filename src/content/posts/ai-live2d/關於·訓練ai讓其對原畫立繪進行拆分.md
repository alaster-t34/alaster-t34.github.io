---
title: 關於·訓練ai讓其對原畫立繪進行拆分的步驟的想法
published: 2025-01-16
description: ''
image: './chaifen.jpg'
tags: [AI, Live2D]
category: 'live2d'
draft: false 
lang: ''
---
## 我是這樣想的，這個過程應該可以通過圖像分割和深度學習來實現。
具體步驟大概如下：
### 1. 收集數據集
需要收集帶有標註的數據集，每張圖片對應著其拆分後的部件
如：
* 原畫立繪圖片，對應多個部件的圖片（如頭髮、衣服、背景、眼睛、嘴巴等）。
* 對應的標註文件，如：每個部件的位置、大小、旋轉角度等。
數據集需要包括：
* 原畫立繪圖片。
* 每個部件的掩碼圖（mask），標註出每個部件的邊界和區域，這是模型學習拆分的關鍵。
#### 數據集的質量對訓練效果至關重要，因此需要標註準確，且數據量足夠多（通常需要數千張圖片及其對應的標註）。
### 2. 訓練模型
訓練模型的目的是讓模型學習到如何分割出每個部件，並且學習到如何合成出完整的立繪。
訓練模型的目標是生成一個模型，可以根據輸入的圖片，輸出每個部件的掩碼圖（mask）和合成圖片。
訓練模型的流程大概如下：
* 選擇模型架構，例如：U-Net、SegNet、FPN、Mask R-CNN、DeepLab等。
* 數據預處理：
            1、圖像縮放與裁剪：將所有圖像統一大小，避免過大的圖像影響訓練效率。<br>
            2、正規化：對圖像進行正規化處理，使其像素值處於 [0, 1] 或 [-1, 1] 的範圍內。<br>
            3、數據增強：對圖片進行隨機裁剪、旋轉、翻轉等操作，增加訓練數據的多樣性，提升模型的泛化能力。
#### 訓練過程：            
* 定義損失函數，例如：交叉熵、Dice Loss、Dice coefficient損失等。
* 定義優化器，例如：Adam、SGD等。
* 訓練模型，使用訓練數據進行模型訓練，根據每次訓練的損失函數來調整模型參數。<br>
**訓練過程中，模型將學習如何將每個像素點分類為不同的部件（如髮型、衣服等），並學會拆分圖像。**
### 3.後處理
訓練完模型後，進行後處理來優化結果：
* 邊緣檢測：檢測模型輸出的掩碼圖（mask）是否有缺陷，如：邊緣太粗、邊緣太細、邊緣太尖等。
* 邊緣修正：對模型輸出的掩碼圖（mask）進行邊緣修正，如：用多邊形裁切、用模糊處理等。
* 小區域去除：去除一些不必要的小區域，避免分割過程中出現噪聲。
### 4.測評
* IoU：用來衡量預測結果和真實標註之間的重疊度。
* Dice係數：用來評估分割結果的準確性，特別是對於類別不平衡的問題。
### 5. 將模型部署到ai上
將訓練好的模型部署到ai上，讓ai可以根據輸入的圖片，輸出每個部件的掩碼圖（mask）和合成圖片。
部署模型的流程大概如下：
* 將訓練好的模型轉換為可部署的格式，例如：ONNX、TensorRT等。
* 將模型部署到ai上，例如：Tensorflow、PyTorch、Caffe、MXNet等。
* 將模型的輸入圖片轉換為模型可以接受的格式，例如：JPG、PNG、BMP等。
* 將模型的輸出掩碼圖（mask）和合成圖片轉換為可視化的格式，例如：JPG、PNG、BMP等。
* 將模型的輸出結果呈現。
### 6. 持續優化
